import json
import sys
from typing import List, Dict, Any
from base_driver import BaseDriver, BaseProblemDriver
from solution import Solution


class AtMostDriver(BaseProblemDriver):
    """Problem-specific driver for AtMost problem."""

    def parse_test_cases(self, input_data: Any, expected_output: Any) -> List[Dict[str, Any]]:
        """Parse input as array, target, and at_most_n_times, and expected output as array of booleans."""
        input_array = json.loads(input_data) if isinstance(input_data, str) else input_data
        expected_array = json.loads(expected_output) if isinstance(expected_output, str) else expected_output
        
        test_cases = []
        
        for i in range(0, len(input_array), 3):
            test_cases.append({
                'input': [input_array[i], input_array[i + 1], input_array[i + 2]],
                'expectedOutput': expected_array[i // 3]
            })
        
        return test_cases

    def execute_test_case(self, test_case: Dict[str, Any], index: int) -> Any:
        """Execute the at_most method with the test case inputs."""
        input_data = test_case['input']
        arr = input_data[0]
        target = input_data[1]
        at_most_n_times = input_data[2]
        
        return Solution.at_most(arr, target, at_most_n_times)

    def compare_results(self, actual: Any, expected: Any) -> bool:
        """Compare results using simple equality."""
        return actual == expected

    def format_error_message(self, actual: Any, expected: Any) -> str:
        """Format error message for failed tests."""
        return f"Expected {expected} but got {actual}"


def main():
    """Main entry point for the driver."""
    # Create and run the driver
    driver = BaseDriver(AtMostDriver())
    driver.run()


if __name__ == "__main__":
    main()
